---
title: js遗漏知识总结
date: 2019-04-09 14:14:02
tags:
---

## 不得不加上的分号

现在在写js的时候，基本上已经会省略掉分号（;）的使用，但是在有些情况省略掉分号就会导致错误。

先直接下结论，在使用 `+` `-` `(` `[` `/` 位于行首的时候需要加上分号。

除了这五种情况外，js会在行尾自动加上分号，但是上面五种情况不会，有些时候就会导致错误。

下列两种情况使用中常出现：

```js
;[arr[1], arr[2]] = [arr[2], arr[1]]
```
```js
;(function(){
    // ....
})()
```
这种时候都需要手动加上分号

## defer async 在script 标签中的作用以及差异

首先，defer 和 async 都是异步加载脚本文件的语法。都只能作用于有src 属性的script 标签

区别在于defer 会在文档解析完成之后，也就是DOMContentLoaded 事件前执行，

而async 在脚本下载完成之后就执行，中断文档的渲染

多个defer 会按照顺序加载执行，而 async会依据下载时间

## 解构赋值使用方法总结

解构赋值，让获取变量的值，更加的优雅，代码更加的易读。

> 小提一句原理，是利用的新增的iterator 接口。

### 数据的解构赋值

常规的情况：
```js
let [a,b,c] = [1,2,3]
```
如果需要忽略某些值，用,,来忽略
```js
let [a,,,d] = [1,2,3,4] // a=a,d=4
```
设定默认值:
```js
let [a=5,b=5] = [2] // a=2,b=5
```
剩余参数的赋值；（使用... , 但是注意，... 一定得是最后一个参数; 如果后面还有参数，请使用,,, 的方法）
```js
let [a,b,...rest] = [1,2,3,4,5] // a = 1, b = 2, rest = [3,4,5]
```
#### 经常使用的场景

下面记录几种经常在使用中利用的方法：

1. 交换变量
```js
[a,b] = [b,a]
```

2. 正则表达式的exec语句、函数参数argument中某个值的获取

exec会返回一个带有很多值的数组，数组中有些的值，是我们不需要的。就可以直接使用解构获取想要的值

### 对象的解构赋值

普通的情况:
```js
let {o, p} = {o:'oVAl',l:'lVAL'} // o = 'oVAl', p = undefined
```
使用对象的解构赋值，左边的值必须是对象中的属性名,如果不是将获取不到值(undefined)。如果需要重命名得使用下面的方法：
```js
let {o:oo, p} = {o:'oVaL',p:'pVAL'} // oo = 'oVAl', p = 'pVAL'
```
注意，如果是没有声明的赋值，需要用()包起来，并且注意使用;(原因上面有讲)
```js
;({o, p} = {o:'oVaL',p:'pVAL'});
```
...rest 和 默认值的使用方法就和数组的差不多了 

## requestAnimationFrame 理解

这是web中专门对优化动画，增加的函数。按照翻译，API的名字应该叫做，**请求动画帧**。

接受一个callback 回调，在屏幕刷新时调用。一般在callback 中还会继续调用requestAnimationFrame, 直到约定的条件达成后，实现动画的效果。

### 屏幕刷新频率

一般的显示器设置的是60HZ，就是一秒钟刷新60次，16.67ms刷新一次。

### 与setTimeout的对比

在没有requestAnimationFrame之前，我们都是使用setTimeout来实现动画的。那为什么使用setTimeout不好呢？

1. 屏幕刷新的频率只是一般来说是60HZ，但是不是绝对的。这个间隔人为设定，会有误差。

2. setTimeout 是在异步队列中执行的，在主线程任务执行完成之后才回去执行。

以上两点，会导致setTimeout的执行步调和屏幕刷新不一致，会导致动画的丢帧。

同时requestAnimationFrame对性能也更加的友好，页面处于未激活状态下，requestAnimationFrame 不会调用，不同于setTimeout。

综上，如果有使用动画的地方，使用requestAnimationFrame 而不是setTImeout